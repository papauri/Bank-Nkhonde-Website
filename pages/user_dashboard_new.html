<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Bank Nkhonde User Dashboard - Manage your savings and loans">
  <title>Dashboard - Bank Nkhonde</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/design-system.css">
  <link rel="stylesheet" href="../styles/dashboard.css">
</head>
<body>
  <!-- Navigation Sidebar -->
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <div class="logo-icon-small">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2"/>
            <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2"/>
            <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <span class="sidebar-logo-text">Bank Nkhonde</span>
      </div>
      <button class="sidebar-toggle" id="sidebarToggle">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="sidebar-menu">
      <a href="#" class="menu-item active" data-section="overview">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <rect x="3" y="3" width="7" height="7" stroke="currentColor" stroke-width="2"/>
          <rect x="14" y="3" width="7" height="7" stroke="currentColor" stroke-width="2"/>
          <rect x="3" y="14" width="7" height="7" stroke="currentColor" stroke-width="2"/>
          <rect x="14" y="14" width="7" height="7" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span>Overview</span>
      </a>
      
      <a href="#" class="menu-item" data-section="payments">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <rect x="1" y="4" width="22" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
          <line x1="1" y1="10" x2="23" y2="10" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span>Payments</span>
      </a>

      <a href="#" class="menu-item" data-section="loans">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>Loans</span>
      </a>

      <a href="#" class="menu-item" data-section="group">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2M9 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>My Group</span>
      </a>

      <a href="#" class="menu-item" data-section="reports">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M3 3v18h18M7 16l4-4 4 4 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>Reports</span>
      </a>

      <a href="#" class="menu-item" data-section="settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
          <path d="M12 1v3m0 16v3M4.22 4.22l2.12 2.12m11.32 11.32l2.12 2.12M1 12h3m16 0h3M4.22 19.78l2.12-2.12m11.32-11.32l2.12-2.12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>Settings</span>
      </a>
    </div>

    <div class="sidebar-footer">
      <div class="user-profile">
        <div class="user-avatar" id="userAvatar">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="user-info">
          <div class="user-name" id="userName">Loading...</div>
          <div class="user-role" id="userRole">Member</div>
        </div>
      </div>
      <button class="btn-logout" id="logoutBtn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Top Bar -->
    <header class="topbar">
      <div class="topbar-left">
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <h1 class="page-title">Dashboard</h1>
      </div>
      <div class="topbar-right">
        <button class="notification-btn" id="notificationBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span class="notification-dot" id="notificationDot"></span>
        </button>
      </div>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
      <!-- Overview Section -->
      <section id="overviewSection" class="dashboard-section active">
        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-card stat-primary">
            <div class="stat-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Total Contributions</div>
              <div class="stat-value" id="totalContributions">MWK 0</div>
              <div class="stat-change positive">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 19V5M5 12l7-7 7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>All time</span>
              </div>
            </div>
          </div>

          <div class="stat-card stat-success">
            <div class="stat-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M22 4L12 14.01l-3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Available Balance</div>
              <div class="stat-value" id="availableBalance">MWK 0</div>
              <div class="stat-change">Current balance</div>
            </div>
          </div>

          <div class="stat-card stat-warning">
            <div class="stat-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Active Loans</div>
              <div class="stat-value" id="activeLoans">MWK 0</div>
              <div class="stat-change"><span id="loanCount">0</span> loans</div>
            </div>
          </div>

          <div class="stat-card stat-danger">
            <div class="stat-icon">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <div class="stat-content">
              <div class="stat-label">Outstanding</div>
              <div class="stat-value" id="outstanding">MWK 0</div>
              <div class="stat-change">To be paid</div>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="section-header">
          <h2>Quick Actions</h2>
        </div>
        <div class="quick-actions-grid">
          <button class="action-btn action-primary" id="makePaymentBtn">
            <div class="action-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <rect x="1" y="4" width="22" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                <line x1="1" y1="10" x2="23" y2="10" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <span class="action-label">Make Payment</span>
          </button>

          <button class="action-btn action-secondary" id="requestLoanBtn">
            <div class="action-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <span class="action-label">Request Loan</span>
          </button>

          <button class="action-btn action-tertiary" id="viewReportsBtn">
            <div class="action-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <span class="action-label">View Reports</span>
          </button>

          <button class="action-btn action-quaternary" id="contactAdminBtn">
            <div class="action-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </div>
            <span class="action-label">Contact Admin</span>
          </button>
        </div>

        <!-- Recent Activity & Upcoming Payments -->
        <div class="grid grid-cols-2">
          <!-- Recent Activity -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Recent Activity</h3>
            </div>
            <div class="card-body">
              <div id="recentActivity" class="activity-list">
                <div class="activity-placeholder">
                  Loading recent activity...
                </div>
              </div>
            </div>
          </div>

          <!-- Upcoming Payments -->
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">Upcoming Payments</h3>
            </div>
            <div class="card-body">
              <div id="upcomingPayments" class="payment-list">
                <div class="payment-placeholder">
                  Loading upcoming payments...
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Other sections will be added here -->
      <section id="paymentsSection" class="dashboard-section">
        <h2>Payments Management</h2>
        <p>Payments section coming soon...</p>
      </section>

      <section id="loansSection" class="dashboard-section">
        <h2>Loans Management</h2>
        <p>Loans section coming soon...</p>
      </section>

      <section id="groupSection" class="dashboard-section">
        <h2>My Group</h2>
        <p>Group details coming soon...</p>
      </section>

      <section id="reportsSection" class="dashboard-section">
        <h2>Financial Reports</h2>
        <p>Reports coming soon...</p>
      </section>

      <section id="settingsSection" class="dashboard-section">
        <h2>Settings</h2>
        <p>Settings coming soon...</p>
      </section>
    </div>
  </main>

  <!-- Loading Overlay -->
  <div class="spinner-overlay hidden" id="loadingOverlay">
    <div class="spinner-content">
      <div class="spinner"></div>
      <p class="loading-text">Loading your dashboard...</p>
    </div>
  </div>

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
  <script type="module" src="../scripts/user_dashboard_new.js"></script>
</body>
</html>
